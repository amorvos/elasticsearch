[[cloud-azure]]
=== Azure Cloud Plugin

The Azure Cloud plugin uses the Azure API for unicast discovery, and adds
support for using Azure as a repository for
{ref}/modules-snapshots.html[Snapshot/Restore].

[[cloud-azure-install]]
[float]
==== Installation

This plugin can be installed using the plugin manager:

[source,sh]
----------------------------------------------------------------
sudo bin/plugin install cloud-azure
----------------------------------------------------------------

The plugin must be installed on every node in the cluster, and each node must
be restarted after installation.

[[cloud-azure-remove]]
[float]
==== Removal

The plugin can be removed with the following command:

[source,sh]
----------------------------------------------------------------
sudo bin/plugin remove cloud-azure
----------------------------------------------------------------

The node must be stopped before removing the plugin.

[[cloud-azure-discovery]]
==== Azure Virtual Machine Discovery

Azure VM discovery allows to use the azure APIs to perform automatic discovery (similar to multicast in non hostile
multicast environments). Here is a simple sample configuration:

[source,yaml]
----
cloud:
    azure:
        management:
             subscription.id: XXX-XXX-XXX-XXX
             resourcegroup.name: es-demo-resource
             tenant.id: XXX-XXX-XXX-XXX
             app:
                id: XXX-XXX-XXX-XXX
                secret: WHATEVER

discovery:
    type: azure
----


[IMPORTANT]
.Binding the network host
==============================================

It's important to define `network.host` as by default it's bound to `localhost`.

You can use {ref}/modules-network.html[core network host settings]. For example `_non_loopback_` or `_en0_`.

==============================================


[[cloud-azure-discovery-short]]
===== How to start (short story)

* Create Azure instances
* Install Elasticsearch
* Install Azure plugin
* Modify `elasticsearch.yml` file
* Start Elasticsearch

[[cloud-azure-discovery-settings]]
===== Azure credential API settings

The following are a list of settings that can further control the credential API:

[horizontal]

`cloud.azure.management.resourcegroup.name`::

    the azure resource group name

`cloud.azure.management.subscription.id`::

    your_azure_subscription_id

`cloud.azure.management.tenant.id`::

    the azure tenant id

`cloud.azure.management.app.id`::

    your azure active directory application id

`cloud.azure.management.app.secret`::

    your_password for the azure active directory application

`discovery.azure.method`

    Default is ``vnet``, allowed values: ``vnet`` or ``subnet``.
    Discovery method ``vnet`` means that all vms
    in the same vnet will be discovered, ``subnet`` means
    that all virtual machines in the same subnet will be added
    to the cluster

// AUTOSENSE
